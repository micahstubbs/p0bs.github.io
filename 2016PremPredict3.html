<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>They think it’s all over …</title>

<script src="site_libs/jquery-2.2.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/htmlwidgets-0.6/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.1.56/datatables.js"></script>
<link href="site_libs/dt-core-1.10.11/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.11/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.11/js/jquery.dataTables.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Robin Penfold</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">HOME</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    BLOG
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="packageForThat.html">Brexit referendum map using R</a>
    </li>
    <li>
      <a href="Batting.html">Batting order of best batsmen</a>
    </li>
    <li>
      <a href="Commute.html">Best commutes to Reigate</a>
    </li>
    <li>
      <a href="Performance.html">Fixing asset manager evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    PREMPREDICT
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://robin.shinyapps.io/PremPredict/">Live leaderboard</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">2015/2016</li>
    <li>
      <a href="2016PremPredict3.html">They think it's all over ...</a>
    </li>
    <li>
      <a href="2016PremPredict2.html">We've all been foxed by Leicester</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    OTHER
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="BrexitDashboard.html">Brexit referendum dashboard</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/InvestmentRP">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://uk.linkedin.com/in/robinpenfold">
    <span class="fa fa-linkedin-square"></span>
     
  </a>
</li>
<li>
  <a href="mailto:robinpenfold@me.com">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">They think it’s all over …</h1>

</div>


<p>… and it pretty much is. Well done, <strong>Roger</strong> – you’ve topped the table for some time and you’re almost sure to do so after the final day.</p>
<p>Whilst the numbers don’t round perfectly, my calculations show that three of us still have some chance of winning. (Of course, others may also have a tiny chance of winning but my calculations don’t show it.)</p>
<p>Pausing to create dramatic tension, I can reveal that:</p>
<ul>
<li><p>Roger Gathercole has about a 97% shot at glory;</p></li>
<li><p>I have about a 3% chance of winning; and</p></li>
<li><p>Beth has about a 1% chance of winning.</p></li>
</ul>
<p>The only downside with the nature of the scores this year, though, is that it’s tough to ascribe someone’s eventual victory to one particular score on Sunday, as there are so many different permutations.</p>
<p>Here are the standings:</p>
<div id="htmlwidget-1758" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1758">{"x":{"filter":"none","data":[["Roger Gathercole","Robin Penfold","Beth Penfold","Liz Moverley","George Quin","John Penfold","Peter Finnis","Alan Finnis","Neil Waterman","Andrea Laporta","Mike Finnis","John Poole","Mark Page","Mathew Saunders","Steve Finnis","Alan Butcher","Marion Finnis","Clare Saunders","Luke Finnis","Hannah Finnis","Ted Cunningham","Laura Finnis","Vera Finnis"],[412,442,476,488,496,502,536,580,594,602,610,628,630,636,642,642,648,666,694,702,782,822,936],[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],["Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City","Leicester City"],[169,100,256,196,196,225,169,361,324,289,324,324,289,289,361,289,324,256,225,289,324,361,361]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Names\u003c/th>\n      <th>Scores\u003c/th>\n      <th>Bonus\u003c/th>\n      <th>WorstClub\u003c/th>\n      <th>WorstCost\u003c/th>\n    \u003c/tr>\n  \u003c/thead>\n\u003c/table>","options":{"dom":"t","pageLength":23,"order":[[1,"asc"],[0,"asc"]],"crosstalkOptions":{"key":null,"group":null},"columnDefs":[{"className":"dt-right","targets":[1,2,4]}],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,23,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row"}},"evals":[],"jsHooks":[]}</script>
<p><br></br></p>
<p>Remember: if you want up-to-the-hour standings, just check <a href="https://robin.shinyapps.io/PremPredict">here</a>.</p>
<p>I’ll be in touch again shortly after the final round of games. But, bottom line: you can feel pretty safe, Roger. Then again, Leicester were longer odds than me and Beth to win and look what happened there!</p>
<p>– Robin</p>
<hr />
<p>PS Here’s my code to prove that all is kosher:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setwd</span>(<span class="st">&quot;~/GitHub/p0bs.github.io/&quot;</span>)

<span class="kw">library</span>(readr)
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(htmlwidgets)
<span class="kw">library</span>(DT)
<span class="kw">library</span>(magrittr)

<span class="co"># Start by running this dimmed code (as PP-thin.R):</span>
<span class="co"># library(rvest)</span>
<span class="co"># library(xml2)</span>
<span class="co"># leagueTable &lt;- read_html(&quot;http://www.theguardian.com/football/premierleague/table&quot;)</span>
<span class="co"># clubOrder &lt;- leagueTable %&gt;%</span>
<span class="co">#   html_nodes(&quot;.table--striped&quot;) %&gt;%</span>
<span class="co">#   .[[1]] %&gt;%</span>
<span class="co">#   html_table()</span>
<span class="co"># saveRDS(clubOrder, &quot;clubOrder.rds&quot;)  # Add date</span>
<span class="co"># Then move clubOrder.rds to appropriate GitHub drive</span>

clubOrder &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;clubOrder160514.rds&quot;</span>)  <span class="co"># Add date</span>

<span class="co"># Rename some teams to make the league table consistent with our inputs</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;Leicester&quot;</span>] &lt;-<span class="st"> &quot;Leicester City&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;Spurs&quot;</span>] &lt;-<span class="st"> &quot;Tottenham Hotspur&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;AFC Bournemouth&quot;</span>] &lt;-<span class="st"> &quot;Bournemouth&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;C Palace&quot;</span>] &lt;-<span class="st"> &quot;Crystal Palace&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;Man City&quot;</span>] &lt;-<span class="st"> &quot;Manchester City&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;Man Utd&quot;</span>] &lt;-<span class="st"> &quot;Manchester United&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;West Ham&quot;</span>] &lt;-<span class="st"> &quot;West Ham United&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;Stoke&quot;</span>] &lt;-<span class="st"> &quot;Stoke City&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;Swansea&quot;</span>] &lt;-<span class="st"> &quot;Swansea City&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;West Brom&quot;</span>] &lt;-<span class="st"> &quot;West Bromwich Albion&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;Norwich&quot;</span>] &lt;-<span class="st"> &quot;Norwich City&quot;</span>
clubOrder$Team[clubOrder$Team==<span class="st">&quot;Newcastle&quot;</span>] &lt;-<span class="st"> &quot;Newcastle United&quot;</span>

clubsABC &lt;-<span class="st"> </span><span class="kw">sort</span>(clubOrder$Team)

dataInput &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;PP-2015.csv&quot;</span>)
clubStandings &lt;-<span class="st"> </span><span class="kw">match</span>(dataInput$Club, clubOrder$Team, <span class="dv">0</span>)
topClub &lt;-<span class="st"> </span><span class="kw">match</span>(<span class="dv">1</span>, clubStandings, <span class="dv">0</span>)

predictions &lt;-<span class="st"> </span>dataInput[,-<span class="dv">1</span>]

bonus &lt;-<span class="st"> </span>-<span class="dv">50</span>*(predictions[topClub,]==<span class="dv">1</span>)
ssq &lt;-<span class="st"> </span>function(x){(x-clubStandings)^<span class="dv">2</span>}
squares &lt;-<span class="st"> </span><span class="kw">apply</span>(predictions,<span class="dv">2</span>,ssq)
score &lt;-<span class="st"> </span><span class="kw">colSums</span>(squares) +<span class="st"> </span>bonus
names &lt;-<span class="st"> </span><span class="kw">colnames</span>(score)
names1 &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(names, <span class="st">&quot;_&quot;</span>, <span class="st">&quot; &quot;</span>)
worst &lt;-<span class="st"> </span><span class="kw">apply</span>(squares,<span class="dv">2</span>,max)
findWorst &lt;-<span class="st"> </span>function(y){<span class="kw">match</span>(worst[y],squares[,y],<span class="dv">0</span>)}
worstClubNo &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span>:<span class="kw">ncol</span>(predictions),findWorst)
worstClub &lt;-<span class="st"> </span>clubsABC[worstClubNo]

output &lt;-<span class="st"> </span><span class="kw">rbind</span>(score, bonus, worst, worstClubNo)
output1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(names1,<span class="kw">t</span>(output))
<span class="kw">row.names</span>(output1) &lt;-<span class="st"> </span><span class="ot">NULL</span> 
output2 &lt;-<span class="st"> </span>output1 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">worstClub=</span>clubsABC[worstClubNo]) %&gt;%
<span class="st">  </span><span class="kw">select</span>(-worstClubNo) 
<span class="kw">colnames</span>(output2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Names&quot;</span>, <span class="st">&quot;Scores&quot;</span>, <span class="st">&quot;Bonus&quot;</span>, <span class="st">&quot;WorstCost&quot;</span>, <span class="st">&quot;WorstClub&quot;</span>)

report &lt;-<span class="st"> </span>output2 %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(Scores) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Names, Scores, Bonus, WorstClub, WorstCost)
<span class="kw">datatable</span>(report, 
          <span class="dt">rownames =</span> <span class="ot">FALSE</span>, 
          <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">dom =</span> <span class="st">&#39;t&#39;</span>,
                         <span class="dt">pageLength =</span> <span class="dv">23</span>,
                         <span class="dt">order =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dv">1</span>, <span class="st">&#39;asc&#39;</span>), <span class="kw">list</span>(<span class="dv">0</span>, <span class="st">&#39;asc&#39;</span>))))</code></pre></div>
<p>And, for completeness, here are your team-by-team predictions and each team’s latest position in the league:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Position &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="dv">1</span>:<span class="dv">20</span>)
clubsOrder &lt;-<span class="st"> </span>clubOrder$Team
clubsOrder1 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(clubsOrder, Position)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">Club =</span> clubsOrder) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(dataInput, <span class="dt">by =</span> <span class="st">&quot;Club&quot;</span>)

<span class="kw">datatable</span>(clubsOrder1,
          <span class="dt">rownames =</span> <span class="ot">FALSE</span>,
          <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">dom =</span> <span class="st">&#39;t&#39;</span>,
                         <span class="dt">pageLength =</span> <span class="dv">20</span>,
                         <span class="dt">order =</span> <span class="kw">list</span>(<span class="dv">0</span>, <span class="st">&#39;asc&#39;</span>),
                         <span class="dt">columnDefs =</span> <span class="kw">list</span>(<span class="kw">list</span>(
            <span class="dt">className =</span> <span class="st">&#39;dt-right&#39;</span>, <span class="dt">targets =</span> <span class="dv">1</span>))))</code></pre></div>
<div id="htmlwidget-3675" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3675">{"x":{"filter":"none","data":[["Leicester City","Tottenham Hotspur","Arsenal","Manchester City","Manchester United","West Ham United","Southampton","Liverpool","Chelsea","Stoke City","Swansea City","Everton","Watford","Crystal Palace","West Bromwich Albion","Bournemouth","Sunderland","Newcastle United","Norwich City","Aston Villa"],["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],[20,5,2,4,3,9,10,6,1,11,7,12,17,8,13,16,19,14,18,15],[20,7,3,4,2,11,6,5,1,9,10,8,17,18,16,14,15,13,19,12],[19,7,2,4,1,16,6,5,3,11,15,8,20,14,12,17,9,10,18,13],[18,6,1,4,3,10,8,5,2,12,17,7,20,9,14,16,15,11,19,13],[18,6,3,4,2,11,8,5,1,10,15,7,20,9,16,19,14,12,17,13],[17,5,1,4,3,8,7,6,2,13,12,10,16,18,11,14,15,9,20,19],[19,7,4,3,2,11,9,5,1,10,8,6,20,12,15,17,16,14,18,13],[19,6,1,4,2,18,7,5,3,8,13,9,16,12,10,11,14,17,15,20],[14,6,1,4,3,18,7,5,2,11,13,9,17,8,16,12,10,15,19,20],[14,6,3,2,4,11,8,5,1,9,10,7,20,13,15,16,18,12,19,17],[11,6,4,3,2,16,9,5,1,10,7,12,20,8,15,17,13,14,19,18],[20,6,1,3,4,11,7,5,2,13,17,9,15,18,19,14,16,12,10,8],[18,5,4,3,1,13,8,6,2,14,11,7,20,17,9,19,16,10,12,15],[18,6,3,2,5,13,7,4,1,11,9,8,20,12,15,17,14,10,19,16],[15,6,1,3,4,10,9,5,2,7,13,12,18,11,19,16,17,8,20,14],[18,7,1,2,5,14,10,4,3,6,11,8,20,9,13,19,15,16,17,12],[17,7,3,4,2,11,9,5,1,10,13,6,20,15,16,19,14,8,18,12],[16,8,2,5,3,17,10,4,1,9,13,6,20,7,15,12,14,11,19,18],[19,6,1,3,5,14,8,4,2,10,11,7,18,9,12,16,13,15,20,17],[19,7,2,3,4,12,10,5,1,9,8,6,20,11,13,17,14,15,16,18],[20,6,2,5,4,14,13,1,3,15,10,12,19,7,17,18,11,8,9,16],[16,6,3,1,4,8,9,5,2,14,7,11,19,10,18,20,12,13,15,17],[15,6,4,5,1,12,9,2,3,7,8,10,19,14,16,20,11,13,18,17]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Club\u003c/th>\n      <th>Position\u003c/th>\n      <th>Alan_Finnis\u003c/th>\n      <th>Steve_Finnis\u003c/th>\n      <th>Ted_Cunningham\u003c/th>\n      <th>Mark_Page\u003c/th>\n      <th>Mathew_Saunders\u003c/th>\n      <th>Beth_Penfold\u003c/th>\n      <th>John_Poole\u003c/th>\n      <th>Marion_Finnis\u003c/th>\n      <th>Peter_Finnis\u003c/th>\n      <th>Roger_Gathercole\u003c/th>\n      <th>Robin_Penfold\u003c/th>\n      <th>Laura_Finnis\u003c/th>\n      <th>Hannah_Finnis\u003c/th>\n      <th>Andrea_Laporta\u003c/th>\n      <th>George_Quin\u003c/th>\n      <th>Alan_Butcher\u003c/th>\n      <th>Clare_Saunders\u003c/th>\n      <th>Luke_Finnis\u003c/th>\n      <th>Neil_Waterman\u003c/th>\n      <th>Mike_Finnis\u003c/th>\n      <th>Vera_Finnis\u003c/th>\n      <th>John_Penfold\u003c/th>\n      <th>Liz_Moverley\u003c/th>\n    \u003c/tr>\n  \u003c/thead>\n\u003c/table>","options":{"dom":"t","pageLength":20,"order":[0,"asc"],"columnDefs":[{"className":"dt-right","targets":1},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]}],"crosstalkOptions":{"key":null,"group":null},"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row"}},"evals":[],"jsHooks":[]}</script>
<hr />
<p>And, for the avoidance of doubt, here are the projections that suggest Roger’s likely success:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(knitr)
<span class="kw">library</span>(compiler)
<span class="kw">library</span>(data.table)

iterations &lt;-<span class="st"> </span><span class="dv">100000</span>

<span class="kw">set.seed</span>(<span class="dv">6</span>)

clubOrder %&lt;&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fullPts =</span> (<span class="dv">1000</span>*Pts) +<span class="st"> </span>GD)

clubsABC &lt;-<span class="st"> </span>clubOrder %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Team, fullPts) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(Team)

clubStandings &lt;-<span class="st"> </span><span class="kw">match</span>(dataInput$Club, clubOrder$Team, <span class="dv">0</span>)


predictions &lt;-<span class="st"> </span>dataInput[,-<span class="dv">1</span>]
nPlayers &lt;-<span class="st"> </span><span class="kw">ncol</span>(predictions)

ssq &lt;-<span class="st"> </span>function(x){<span class="kw">sum</span>((x-clubStandings)^<span class="dv">2</span>)}
cssq &lt;-<span class="st"> </span><span class="kw">cmpfun</span>(ssq)

score &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">apply</span>(predictions,<span class="dv">2</span>,ssq))

names &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">rownames</span>(score))
names1 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">str_replace_all</span>(<span class="kw">t</span>(names), <span class="st">&quot;_&quot;</span>, <span class="st">&quot; &quot;</span>))
output1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(names1, score)
<span class="kw">rownames</span>(output1) &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">colnames</span>(output1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Names&quot;</span>, <span class="st">&quot;Score&quot;</span>)

game &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">c</span>(<span class="st">&quot;CheLei&quot;</span>, <span class="st">&quot;EveNor&quot;</span>, <span class="st">&quot;MnuBou&quot;</span>, <span class="st">&quot;SouCry&quot;</span>, <span class="st">&quot;NewTot&quot;</span>, <span class="st">&quot;WatSun&quot;</span>, <span class="st">&quot;SwaMci&quot;</span>, <span class="st">&quot;StoWhu&quot;</span>, <span class="st">&quot;WbaLiv&quot;</span>, <span class="st">&quot;ArsAst&quot;</span>))
winSlice &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">c</span>(<span class="fl">0.4335</span>, <span class="fl">0.5128</span>, <span class="fl">0.7162</span>, <span class="fl">0.7162</span>, <span class="fl">0.2187</span>, <span class="fl">0.4428</span>, <span class="fl">0.1798</span>, <span class="fl">0.2778</span>, <span class="fl">0.396</span>, <span class="fl">0.8364</span>))
drawSlice &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">c</span>(<span class="fl">0.7044</span>, <span class="fl">0.7564</span>, <span class="fl">0.9023</span>, <span class="fl">0.9023</span>, <span class="fl">0.4654</span>, <span class="fl">0.7135</span>, <span class="fl">0.3767</span>, <span class="fl">0.537</span>, <span class="fl">0.6655</span>, <span class="fl">0.9512</span>))

gameOdds &lt;-<span class="st"> </span><span class="kw">cbind</span>(game, winSlice, drawSlice)

iteration &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="dv">1</span>:iterations)

vectorRandom &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">ceiling</span>(<span class="kw">runif</span>(<span class="dv">10</span>*iterations, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">7</span>)))
netGameGoals &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> vectorRandom, <span class="dt">ncol =</span> <span class="dv">10</span>)
<span class="kw">colnames</span>(netGameGoals) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;nCheLei&quot;</span>, <span class="st">&quot;nEveNor&quot;</span>, <span class="st">&quot;nMnuBou&quot;</span>, <span class="st">&quot;nSouCry&quot;</span>, <span class="st">&quot;nNewTot&quot;</span>, <span class="st">&quot;nWatSun&quot;</span>, <span class="st">&quot;nSwaMci&quot;</span>, <span class="st">&quot;nStoWhu&quot;</span>, <span class="st">&quot;nWbaLiv&quot;</span>, <span class="st">&quot;nArsAst&quot;</span>)

unitVectorRandom &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">runif</span>(<span class="dv">10</span>*iterations, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>))
randomGameValues &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> unitVectorRandom, <span class="dt">ncol =</span> <span class="dv">10</span>)
<span class="kw">colnames</span>(randomGameValues) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;rCheLei&quot;</span>, <span class="st">&quot;rEveNor&quot;</span>, <span class="st">&quot;rMnuBou&quot;</span>, <span class="st">&quot;rSouCry&quot;</span>, <span class="st">&quot;rNewTot&quot;</span>, <span class="st">&quot;rWatSun&quot;</span>, <span class="st">&quot;rSwaMci&quot;</span>, <span class="st">&quot;rStoWhu&quot;</span>, <span class="st">&quot;rWbaLiv&quot;</span>, <span class="st">&quot;rArsAst&quot;</span>)

simulatedCalcs &lt;-<span class="st"> </span><span class="kw">cbind</span>(iteration, randomGameValues, netGameGoals)

<span class="co"># I got lazy with code and know that I should tidy it into a function at some stage</span>
simulatedCalcs %&lt;&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Ars=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Arsenal&quot;</span>] +<span class="st"> </span>
<span class="st">           </span><span class="kw">ifelse</span>(rArsAst&lt;gameOdds[<span class="dv">10</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nArsAst, <span class="kw">ifelse</span>(rArsAst&lt;gameOdds[<span class="dv">10</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nArsAst))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Ast=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Aston Villa&quot;</span>] +<span class="st"> </span>
<span class="st">           </span><span class="kw">ifelse</span>(rArsAst&lt;gameOdds[<span class="dv">10</span>,<span class="dv">2</span>], -nArsAst, <span class="kw">ifelse</span>(rArsAst&lt;gameOdds[<span class="dv">10</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nArsAst))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Bou=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Bournemouth&quot;</span>] +<span class="st"> </span>
<span class="st">           </span><span class="kw">ifelse</span>(rMnuBou&lt;gameOdds[<span class="dv">3</span>,<span class="dv">2</span>], -nMnuBou, <span class="kw">ifelse</span>(rMnuBou&lt;gameOdds[<span class="dv">3</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nMnuBou))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Che=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Chelsea&quot;</span>] +<span class="st"> </span>
<span class="st">           </span><span class="kw">ifelse</span>(rCheLei&lt;gameOdds[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nCheLei, <span class="kw">ifelse</span>(rCheLei&lt;gameOdds[<span class="dv">1</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nCheLei))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Cry=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Crystal Palace&quot;</span>] +<span class="st"> </span>
<span class="st">           </span><span class="kw">ifelse</span>(rSouCry&lt;gameOdds[<span class="dv">4</span>,<span class="dv">2</span>], -nSouCry, <span class="kw">ifelse</span>(rSouCry&lt;gameOdds[<span class="dv">4</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nSouCry))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Eve=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Everton&quot;</span>] +<span class="st"> </span>
<span class="st">         </span><span class="kw">ifelse</span>(rEveNor&lt;gameOdds[<span class="dv">2</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nEveNor, <span class="kw">ifelse</span>(rEveNor&lt;gameOdds[<span class="dv">2</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nEveNor))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Lei=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Leicester City&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rCheLei&lt;gameOdds[<span class="dv">1</span>,<span class="dv">2</span>], -nCheLei, <span class="kw">ifelse</span>(rCheLei&lt;gameOdds[<span class="dv">1</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nCheLei))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Liv=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Liverpool&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rWbaLiv&lt;gameOdds[<span class="dv">9</span>,<span class="dv">2</span>], -nWbaLiv, <span class="kw">ifelse</span>(rWbaLiv&lt;gameOdds[<span class="dv">9</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nWbaLiv))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Mci=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Manchester City&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rSwaMci&lt;gameOdds[<span class="dv">7</span>,<span class="dv">2</span>], -nSwaMci, <span class="kw">ifelse</span>(rSwaMci&lt;gameOdds[<span class="dv">7</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nSwaMci))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Mnu=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Manchester United&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rMnuBou&lt;gameOdds[<span class="dv">3</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nMnuBou, <span class="kw">ifelse</span>(rMnuBou&lt;gameOdds[<span class="dv">3</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nMnuBou))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">New=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Newcastle United&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rNewTot&lt;gameOdds[<span class="dv">5</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nNewTot, <span class="kw">ifelse</span>(rNewTot&lt;gameOdds[<span class="dv">5</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nNewTot))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Nor=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Norwich City&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rEveNor&lt;gameOdds[<span class="dv">2</span>,<span class="dv">2</span>], -nEveNor, <span class="kw">ifelse</span>(rEveNor&lt;gameOdds[<span class="dv">2</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nEveNor))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sou=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Southampton&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rSouCry&lt;gameOdds[<span class="dv">4</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nSouCry, <span class="kw">ifelse</span>(rSouCry&lt;gameOdds[<span class="dv">4</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nSouCry))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sto=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Stoke City&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rStoWhu&lt;gameOdds[<span class="dv">8</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nStoWhu, <span class="kw">ifelse</span>(rStoWhu&lt;gameOdds[<span class="dv">8</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nStoWhu))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sun=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Sunderland&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rWatSun&lt;gameOdds[<span class="dv">6</span>,<span class="dv">2</span>], -nWatSun, <span class="kw">ifelse</span>(rWatSun&lt;gameOdds[<span class="dv">6</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nWatSun))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Swa=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Swansea City&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rSwaMci&lt;gameOdds[<span class="dv">7</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nSwaMci, <span class="kw">ifelse</span>(rSwaMci&lt;gameOdds[<span class="dv">7</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nSwaMci))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Tot=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Tottenham Hotspur&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rNewTot&lt;gameOdds[<span class="dv">5</span>,<span class="dv">2</span>], -nNewTot, <span class="kw">ifelse</span>(rNewTot&lt;gameOdds[<span class="dv">5</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nNewTot))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Wat=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;Watford&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rWatSun&lt;gameOdds[<span class="dv">6</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nWatSun, <span class="kw">ifelse</span>(rWatSun&lt;gameOdds[<span class="dv">6</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nWatSun))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Wba=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;West Bromwich Albion&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rWbaLiv&lt;gameOdds[<span class="dv">9</span>,<span class="dv">2</span>], <span class="dv">3000</span>+nWbaLiv, <span class="kw">ifelse</span>(rWbaLiv&lt;gameOdds[<span class="dv">9</span>,<span class="dv">3</span>], <span class="dv">1000</span>, -nWbaLiv))) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Whu=</span>clubsABC$fullPts[clubsABC==<span class="st">&quot;West Ham United&quot;</span>] +<span class="st"> </span>
<span class="st">             </span><span class="kw">ifelse</span>(rStoWhu&lt;gameOdds[<span class="dv">8</span>,<span class="dv">2</span>], -nStoWhu, <span class="kw">ifelse</span>(rStoWhu&lt;gameOdds[<span class="dv">8</span>,<span class="dv">3</span>], <span class="dv">1000</span>, <span class="dv">3000</span>+nStoWhu)))
    
simClubScores &lt;-<span class="st"> </span>simulatedCalcs %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Ars:Whu)

simClubOrderString &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">apply</span>(-simClubScores, <span class="dv">1</span>, rank, <span class="dt">ties.method=</span><span class="st">&quot;average&quot;</span>))
tsimClubOrder &lt;-<span class="st"> </span><span class="kw">matrix</span>(simClubOrderString, <span class="dt">nrow =</span> <span class="dv">20</span>)
simClubOrder &lt;-<span class="st"> </span><span class="kw">t</span>(tsimClubOrder)

simClubOrder &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">t</span>(tsimClubOrder))

<span class="kw">colnames</span>(simClubOrder) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Arsenal&quot;</span>, <span class="st">&quot;Aston Villa&quot;</span>, <span class="st">&quot;Bournemouth&quot;</span>, <span class="st">&quot;Chelsea&quot;</span>, <span class="st">&quot;Crystal Palace&quot;</span>, <span class="st">&quot;Everton&quot;</span>, <span class="st">&quot;Leicester City&quot;</span>, <span class="st">&quot;Liverpool&quot;</span>,
                            <span class="st">&quot;Manchester City&quot;</span>, <span class="st">&quot;Manchester United&quot;</span>, <span class="st">&quot;Newcastle United&quot;</span>, <span class="st">&quot;Norwich City&quot;</span>, <span class="st">&quot;Southampton&quot;</span>, <span class="st">&quot;Stoke City&quot;</span>,
                            <span class="st">&quot;Sunderland&quot;</span>, <span class="st">&quot;Swansea City&quot;</span>, <span class="st">&quot;Tottenham Hotspur&quot;</span>, <span class="st">&quot;Watford&quot;</span>, <span class="st">&quot;West Bromwich Albion&quot;</span>, <span class="st">&quot;West Ham United&quot;</span>)


simPlayerScores &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(0L, nPlayers*iterations), <span class="dt">nrow =</span> iterations)
tPredictions &lt;-<span class="st"> </span><span class="kw">t</span>(predictions)

<span class="co"># No need to calculate bonus as nobody chose Leicester (who are already champions)</span>

for (i in <span class="dv">1</span>:nPlayers){
  mPredictions &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(tPredictions[i,], iterations), <span class="dt">nrow =</span> iterations, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
  workingMisses &lt;-<span class="st"> </span>(simClubOrder -<span class="st"> </span>mPredictions)^<span class="dv">2</span>
  simPlayerScores[,i] &lt;-<span class="st"> </span><span class="kw">rowSums</span>(workingMisses)
}

<span class="kw">colnames</span>(simPlayerScores) &lt;-<span class="st"> </span><span class="kw">t</span>(names1)

simPlayerRanks &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">apply</span>(simPlayerScores, <span class="dv">1</span>, rank, <span class="dt">ties.method=</span><span class="st">&#39;min&#39;</span>)))
winPlayer &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(simPlayerRanks==1L)
winLikelihood &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">apply</span>(winPlayer, <span class="dv">2</span>, sum))
<span class="kw">setnames</span>(winLikelihood, <span class="dv">1</span>, <span class="st">&quot;Frequency&quot;</span>)
<span class="kw">setnames</span>(names1, <span class="dv">1</span>, <span class="st">&quot;Name&quot;</span>)
winSummary &lt;-<span class="st"> </span><span class="kw">cbind</span>(names1, winLikelihood)

winSummary %&lt;&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(Frequency &gt;<span class="st"> </span><span class="dv">0</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(-Frequency) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Likelihood =</span> Frequency/iterations) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Name, Likelihood)

<span class="kw">kable</span>(winSummary)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="right">Likelihood</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Roger Gathercole</td>
<td align="right">0.96810</td>
</tr>
<tr class="even">
<td align="left">Robin Penfold</td>
<td align="right">0.03142</td>
</tr>
<tr class="odd">
<td align="left">Beth Penfold</td>
<td align="right">0.00915</td>
</tr>
</tbody>
</table>
<hr />

<font-size:10>Copyright &copy; 2016 Robin Penfold. Built using Rmarkdown and GitHub pages.</font-size>



</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
